<!DOCTYPE html>
<html lang="fa" dir="rtl" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title data-i18n="title">شبیه‌ساز لاتاری حرفه‌ای</title>
  <style>
    /* Inline theme to ensure it loads immediately */
    html[data-theme="dark"] {
      --page: #0C1015;
      --box: #13171F;
      --border: #1B212C;
      --primary: #06FFFF;
      --secondary: #3583F6;
      --error: #DB3458;
      --text: #FFFFFF;
      --muted: #818A9C;
      --ring: rgba(6, 255, 255, 0.3);
      --shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    html[data-theme="light"] {
      --page: #F4F7FB;
      --box: #FFFFFF;
      --border: #DCE6F5;
      --primary: #05C2C2;
      --secondary: #4F7DFF;
      --error: #E64262;
      --text: #0F1A2B;
      --muted: #5D6F93;
      --ring: rgba(79, 125, 255, 0.2);
      --shadow: 0 8px 24px rgba(15, 26, 43, 0.12);
    }
    body {
      background:
        radial-gradient(55% 55% at 85% -10%, rgba(6, 255, 255, 0.1), transparent 60%),
        radial-gradient(50% 50% at 10% 0%, rgba(53, 131, 246, 0.08), transparent 70%),
        #0C1015;
      color: var(--text);
      margin: 0;
      padding: 0;
    }
  </style>
  <link rel="stylesheet" href="./css/tokens.css">
  <link rel="stylesheet" href="./css/fontawesome.min.css">
  <link rel="stylesheet" href="./css/solid.min.css">
  <link rel="stylesheet" href="./css/base.css">
  <link rel="stylesheet" href="./css/layout.css">
  <link rel="stylesheet" href="./css/components.css">
  <link rel="stylesheet" href="./css/theme.css">

</head>
<body>
     <script src="./js/offline-loader.js" defer></script>

  <div id="app" class="layout">
    <header class="dashboard-header panel">
      <div class="app-bar">
        <div class="app-branding">
          <span class="app-branding__tag" data-i18n="appSuite">سوئیت پیشرفته</span>
          <h1 class="header-title" data-i18n="title">شبیه‌ساز پیشرفته لاتاری</h1>
        </div>
        <div class="app-quick-actions">
          <label class="app-quick-actions__control">
            <span data-i18n="language">زبان</span>
            <select id="lang-select" data-hook="toggle-lang">
              <option value="fa" data-i18n="persian">فارسی</option>
              <option value="en" data-i18n="english">English</option>
            </select>
          </label>
          <label class="theme-switch" for="theme-toggle">
            <span data-i18n="theme">تم</span>
            <input type="checkbox" id="theme-toggle" role="switch" aria-label="Toggle theme">
            <span class="switch-track"><span class="switch-thumb"></span></span>
            <select id="theme-select" data-hook="toggle-theme" class="visually-hidden">
              <option value="dark" data-i18n="dark">تاریک</option>
              <option value="light" data-i18n="light">روشن</option>
            </select>
          </label>
          <button id="btn-currency" type="button" class="app-action" data-i18n="currencySettings">
            تنظیمات ارز
          </button>
          <button type="button" class="app-help">
            <i class="fa-solid fa-circle-question" aria-hidden="true"></i>
            <span data-i18n="help">راهنما</span>
          </button>
        </div>
      </div>
    </header>

    <!-- Column 1: Settings & Controls -->
    <aside class="column col-settings">
      <div class="panel result-card">
        <div class="result-card__header">
          <div>
            <h3 data-i18n="resultTitle">نتیجه بازی</h3>
            <p class="result-card__subtitle" data-i18n="resultSubtitle">کنترل ترکیب هدف و روند خرید روزانه</p>
          </div>
          <span class="result-card__badge">LIVE</span>
        </div>
        <div class="result-mode">
          <button type="button" class="mode-toggle active" data-result-mode="variable" data-i18n="resultVariable">نتیجه متغیر</button>
          <button type="button" class="mode-toggle" data-result-mode="fixed" data-i18n="resultFixed">نتیجه ثابت</button>
        </div>
        <div class="draw-balls" id="current-ticket"></div>
        <div class="draw-summary" id="day-result"></div>
        <div class="result-form">
          <label>
            <span data-i18n="ticketsPerDay">تیکت در روز</span>
            <input type="number" id="tickets-per-day" min="0" value="0" placeholder="0=نامحدود">
          </label>
          <label>
            <span data-i18n="totalTickets">مجموع بلیت‌ها</span>
            <input type="number" id="total-tickets" min="0" value="0" placeholder="0=نامحدود">
          </label>
        </div>
        <div class="result-fixed-fields" id="result-fixed-fields" style="display:none">
          <label>
            <span data-i18n="fixedNumbersLabel">اعداد ثابت (با کاما):</span>
            <input type="text" id="fixed-main-input" placeholder="7,12,18,25,32,36">
          </label>
          <label>
            <span data-i18n="fixedBonusLabel">شماره بونوس:</span>
            <input type="number" id="fixed-bonus-input" min="1" max="50">
          </label>
          <div class="result-fixed-preview" id="fixed-preview"></div>
        </div>
      </div>
      <div class="panel resource-knobs">
        <h3 data-i18n="resourceSettings">تنظیمات عملکرد</h3>
        <div class="control-row">
          <label data-i18n="batchSize">اندازه دسته:</label>
          <input type="number" id="batch-size" min="200" max="10000" value="1000">
        </div>
        <div class="control-row">
          <label data-i18n="uiDelay">تأخیر رابط:</label>
          <input type="number" id="ui-delay" min="50" max="1000" value="200" step="50">
          <span class="unit">ms</span>
        </div>
        <div class="control-row">
          <label data-i18n="maxLogRows">حد ردیف‌های لاگ:</label>
          <input type="number" id="max-log-rows" min="1000" max="500000" value="50000" step="1000">
        </div>
        <div class="control-row">
          <label data-i18n="chartCap">حد داده‌های نمودار:</label>
          <input type="number" id="chart-cap" min="500" max="10000" value="2000" step="500">
        </div>
        <div class="control-row">
          <label class="toggle">
            <input type="checkbox" id="eco-mode">
            <span data-i18n="ecoMode">حالت اکو</span>
          </label>
        </div>
        <div class="control-row" id="eco-rate-row" style="display:none">
          <label data-i18n="rateCap">حد نرخ:</label>
          <input type="number" id="eco-rate-cap" min="10" max="10000" value="500" step="10">
          <span class="unit">ت/ث</span>
        </div>
      </div>

      <div class="panel game-settings">
        <h3 data-i18n="gameSettings">تنظیمات بازی</h3>
        <div class="control-row">
          <label data-i18n="preset">پیش‌تنظیم:</label>
          <select id="game-preset">
            <option value="classic6" data-i18n="classic6">کلاسیک 6/49</option>
            <option value="mini5" data-i18n="mini5">مینی 5/35</option>
            <option value="custom" data-i18n="custom">سفارشی</option>
          </select>
        </div>
        <div class="game-grid">
          <label>
            <span data-i18n="maxMain">بازه اصلی (۱ تا N):</span>
            <input type="number" id="max-main" min="5" max="100" value="49">
          </label>
          <label>
            <span data-i18n="mainCount">تعداد اعداد (K):</span>
            <input type="number" id="main-count" min="3" max="20" value="6">
          </label>
        </div>
        <div class="bonus-toggle">
          <label class="toggle">
            <input type="checkbox" id="has-bonus">
            <span data-i18n="hasBonus">شماره جایزه</span>
          </label>
          <div class="bonus-fields" id="max-bonus-row" style="display:none">
            <label>
              <span data-i18n="maxBonus">حد بونوس:</span>
              <input type="number" id="max-bonus" min="1" max="50" value="10">
            </label>
          </div>
        </div>
        <div class="pricing-row">
          <label data-i18n="ticketPrice">قیمت تیکت:</label>
          <div class="pricing-input">
            <input type="number" id="ticket-price" min="0.01" step="0.01" value="2.00">
            <span id="ticket-price-sym" class="unit">$</span>
          </div>
        </div>
      </div>

      <div class="panel prize-map">
        <div class="panel-headline">
          <h3 data-i18n="prizeMap">تنظیمات جوایز</h3>
          <button id="btn-generate-prize-map" class="btn btn-ghost" data-i18n="restoreDefaultPrizes">
            <i class="fa-solid fa-rotate-left" aria-hidden="true"></i>
            <span data-i18n="restoreDefaultPrizes">بازنشانی پیش‌فرض</span>
          </button>
        </div>
        <p class="panel-description" data-i18n="prizeMapHint">سطوح جایزه را بر اساس نوع لاتاری تنظیم کنید.</p>
        <div id="prize-map-visual" class="prize-tiers"></div>
        <details class="prize-raw">
          <summary data-i18n="prizeMapRaw">ویرایش دستی</summary>
          <p class="panel-description" data-i18n="prizeMapRawHint">برای هر خط از الگوی m[,b]=VALUE استفاده کنید. مقادیر JACKPOT و FREE_PLAY نیز قابل قبول هستند.</p>
          <textarea id="prize-map-text" rows="8" placeholder="m[,b]=JACKPOT|FREE_PLAY|&lt;minor&gt;"></textarea>
          <div class="button-group">
            <button id="btn-parse-prize" class="btn btn-accent" data-i18n="parse">تجزیه</button>
            <button id="btn-sync-prize" class="btn btn-primary" data-i18n="sync">همگام‌سازی</button>
          </div>
        </details>
      </div>
    </aside>

    <!-- Column 2: Ticket Builder & Live Purchase -->
    <section class="column col-ticket">
      <div class="panel ticket-builder">
        <header class="ticket-head">
          <div>
            <h3 data-i18n="ticketBuilder">انتخاب تیکت</h3>
            <p class="ticket-head__subtitle" data-i18n="ticketBuilderHint">ابزار مناسب را انتخاب کنید و به صورت دقیق کارت خود را بچینید.</p>
          </div>
        </header>
        <hr class="ticket-divider">
        <div class="ticket-tools">
          <span class="ticket-tool-label" data-i18n="ticketToolLabel">ابزار انتخاب کارت:</span>
          <div class="ticket-toolbar" role="group">
            <button class="tool-toggle active" data-mode="select" data-tooltip-key="toolManualTooltip" aria-label="انتخاب">
              <i class="fa-solid fa-hand-pointer" aria-hidden="true"></i>
            </button>
            <button class="tool-toggle" data-mode="pin" data-tooltip-key="toolLockTooltip" aria-label="قفل">
              <i class="fa-solid fa-lock" aria-hidden="true"></i>
            </button>
            <button class="tool-toggle" data-mode="prefer" data-tooltip-key="toolHotTooltip" aria-label="شانس بیشتر">
              <i class="fa-solid fa-fire" aria-hidden="true"></i>
            </button>
            <button class="tool-toggle" data-mode="exclude" data-tooltip-key="toolRemoveTooltip" aria-label="حذف">
              <i class="fa-solid fa-xmark" aria-hidden="true"></i>
            </button>
          </div>
        </div>
        <div class="ticket-legend">
          <span class="legend-chip" id="pinned-counter">قفل: 0/<span id="pinned-max">6</span></span>
          <span class="legend-chip" id="preferred-counter">شانس بیشتر: 0</span>
          <span class="legend-chip" id="excluded-counter">حذف: 0</span>
        </div>
        <div class="number-grid" id="number-grid"></div>
        <div class="ticket-primary-actions">
          <button id="btn-random-pick" class="ticket-random-btn" data-i18n="randomSelect">
            <i class="fa-solid fa-shuffle" aria-hidden="true"></i>
            <span>انتخاب تصادفی</span>
          </button>
          <button id="btn-reset-grid" class="btn btn-ghost" data-i18n="resetSelection">
            <i class="fa-solid fa-rotate-left" aria-hidden="true"></i>
            <span>ریست انتخاب‌ها</span>
          </button>
        </div>
        <div class="ticket-filters">
          <span class="ticket-filters__label" data-i18n="filterHeading">فیلترها:</span>
          <div class="filter-chips">
            <button class="filter-chip" data-filter="even" data-i18n="filterEven">اعداد زوج</button>
            <button class="filter-chip" data-filter="odd" data-i18n="filterOdd">اعداد فرد</button>
            <button class="filter-chip" data-filter="prime" data-i18n="filterPrime">اعداد اول</button>
            <button class="filter-chip" data-filter="low" data-i18n="filterLow">نیمه اول</button>
            <button class="filter-chip" data-filter="high" data-i18n="filterHigh">نیمه دوم</button>
          </div>
        </div>
        <div class="queue-controls">
          <div class="queue-controls__auto">
            <label for="queue-count" data-i18n="queueCount">تعداد بلیت تصادفی</label>
            <div class="queue-form">
              <input type="number" id="queue-count" min="1" max="500" value="10">
              <button id="btn-queue-random" class="btn btn-secondary" data-i18n="queueRandom">
                <i class="fa-solid fa-layer-group" aria-hidden="true"></i>
                <span>افزودن به صف</span>
              </button>
            </div>
          </div>
          <div class="queue-controls__manual">
            <button id="btn-add-ticket" class="btn btn-primary" disabled data-i18n="addTicket">
              <i class="fa-solid fa-plus" aria-hidden="true"></i>
              <span>افزودن بلیت</span>
            </button>
            <button id="btn-clear-queue" class="btn btn-warn" data-i18n="clearQueue">
              <i class="fa-solid fa-trash" aria-hidden="true"></i>
              <span>پاکسازی صف</span>
            </button>
          </div>
        </div>
        <div class="queue-display">
          <h4 data-i18n="ticketQueue">صف بلیت‌ها</h4>
          <div id="queue-chips" class="queue-chips" data-empty-label="هنوز بلیتی در صف نیست"></div>
        </div>
      </div>
    </section>

    <!-- Column 3: Analytics & Logs -->
    <section class="column col-main">
      <div class="panel sim-console">
        <div class="sim-console__row">
          <div class="header-status">
            <span class="status-chip" id="status-chip" data-i18n="statusIdle">بیکار</span>
            <div class="status-metrics">
              <span class="status-metric" id="rate-display">0 <span data-i18n="ticketsSec">تیکت/ثانیه</span></span>
              <span class="status-metric" id="elapsed-display">00:00:00</span>
            </div>
          </div>
          <div class="sim-console__toggles">
            <label class="toggle header-toggle">
              <input type="checkbox" id="stop-on-jackpot">
              <span data-i18n="stopOnJackpot">توقف در جکپات</span>
            </label>
            <div class="header-limit">
              <label for="limit-kind" data-i18n="runLimit">حد اجرا</label>
              <div class="limit-fields">
                <select id="limit-kind">
                  <option value="tickets" data-i18n="tickets">تیکت</option>
                  <option value="minutes" data-i18n="minutes">دقیقه</option>
                  <option value="days" data-i18n="days">روز</option>
                </select>
                <input type="number" id="limit-value" min="0" value="0" placeholder="0=نامحدود">
              </div>
            </div>
          </div>
        </div>
        <div class="sim-console__actions">
          <button id="btn-start" data-hook="btn-start" class="btn btn-primary">
            <i class="fa-solid fa-play" aria-hidden="true"></i>
            <span data-i18n="start">شروع</span>
          </button>
          <button id="btn-pause" data-hook="btn-pause" class="btn btn-secondary" disabled>
            <i class="fa-solid fa-pause" aria-hidden="true"></i>
            <span data-i18n="pause">توقف موقت</span>
          </button>
          <button id="btn-stop" data-hook="btn-stop" class="btn btn-danger" disabled>
            <i class="fa-solid fa-stop" aria-hidden="true"></i>
            <span data-i18n="stop">توقف</span>
          </button>
          <button id="btn-reset" data-hook="btn-reset" class="btn btn-warn">
            <i class="fa-solid fa-rotate-left" aria-hidden="true"></i>
            <span data-i18n="reset">بازنشانی</span>
          </button>
          <button id="btn-export" data-hook="btn-export" class="btn btn-accent">
            <i class="fa-solid fa-download" aria-hidden="true"></i>
            <span data-i18n="exportCsv">خروجی CSV</span>
          </button>
        </div>
      </div>
      <div class="panel kpis">
        <h3 data-i18n="analytics">تحلیل</h3>
        <div class="kpi-grid">
          <div class="kpi-card">
            <span class="kpi-label" data-i18n="tickets">تیکت‌ها</span>
            <span class="kpi-value" id="kpi-tickets">0</span>
          </div>
          <div class="kpi-card">
            <span class="kpi-label" data-i18n="days">روزها</span>
            <span class="kpi-value" id="kpi-days">0</span>
          </div>
          <div class="kpi-card">
            <span class="kpi-label" data-i18n="jackpots">جکپات‌ها</span>
            <span class="kpi-value" id="kpi-jackpots">0</span>
          </div>
          <div class="kpi-card">
            <span class="kpi-label" data-i18n="spent">خرج شده</span>
            <span class="kpi-value" id="kpi-spent">$0</span>
          </div>
          <div class="kpi-card">
            <span class="kpi-label" data-i18n="paid">پرداخت شده</span>
            <span class="kpi-value" id="kpi-paid">$0</span>
          </div>
          <div class="kpi-card">
            <span class="kpi-label" data-i18n="net">خالص</span>
            <span class="kpi-value" id="kpi-net">$0</span>
          </div>
          <div class="kpi-card">
            <span class="kpi-label" data-i18n="roi">ROI</span>
            <span class="kpi-value" id="kpi-roi">0%</span>
          </div>
        </div>
      </div>

      <div class="panel charts">
        <h3 data-i18n="charts">نمودارها</h3>
        <div class="chart-container">
          <canvas id="chart-pl" class="chart-canvas"></canvas>
          <label data-i18n="profitLoss">سود/زیان</label>
        </div>
        <div class="chart-container">
          <canvas id="chart-roi" class="chart-canvas"></canvas>
          <label data-i18n="roi">ROI (%)</label>
        </div>
        <div class="chart-container">
          <canvas id="chart-daily" class="chart-canvas"></canvas>
          <label data-i18n="dailyPnL">سود/زیان روزانه</label>
        </div>
        <div class="chart-container">
          <canvas id="chart-hits" class="chart-canvas"></canvas>
          <label data-i18n="hitDistribution">توزیع برخورد</label>
        </div>
      </div>

      <div class="panel logs">
        <h3 data-i18n="logs">لاگ‌ها</h3>
        <div class="log-controls">
          <label class="toggle">
            <input type="checkbox" id="log-wins-only">
            <span data-i18n="winsOnly">فقط بردها</span>
          </label>
          <input type="number" id="log-min-prize" placeholder="حداقل جایزه" min="0">
          <input type="number" id="log-max-prize" placeholder="حداکثر جایزه" min="0">
          <input type="number" id="log-min-match" placeholder="حداقل تطابق" min="0" max="20">
          <input type="text" id="log-search" placeholder="جستجو...">
        </div>
        <div class="log-tabs" data-hook="tabs">
          <button class="log-tab active" data-tab="purchases" data-i18n="purchases">خریدها</button>
          <button class="log-tab" data-tab="wins" data-i18n="wins">بردها</button>
        </div>
        <div class="log-table">
          <div class="log-header" id="log-header"></div>
          <div class="log-viewport" id="log-viewport">
            <div data-panel="purchases" id="panel-purchases">
              <div class="log-spacer-top" id="log-spacer-top"></div>
              <div class="log-content" id="log-content"></div>
              <div class="log-spacer-bottom" id="log-spacer-bottom"></div>
            </div>
            <div data-panel="wins" id="panel-wins" hidden>
              <div class="log-spacer-top" id="log-spacer-top-wins"></div>
              <div class="log-content" id="log-content-wins"></div>
              <div class="log-spacer-bottom" id="log-spacer-bottom-wins"></div>
            </div>
          </div>
        </div>
        <div class="log-meta" id="log-count"></div>
      </div>
    </section>
  </div>

  <!-- Currency Modal -->
  <div id="currency-modal" class="modal">
    <div class="modal-content">
      <h3 data-i18n="currencySettings">تنظیمات ارز</h3>
      <div class="currency-form">
        <div class="form-group">
          <label data-i18n="baseCurrency">ارز پایه:</label>
          <input type="text" id="base-code" placeholder="USD" maxlength="3">
          <input type="text" id="base-sym" placeholder="$" maxlength="5">
          <input type="number" id="base-minor" placeholder="100" value="100">
        </div>
        <div class="form-group">
          <label data-i18n="secondaryCurrency">ارز ثانویه:</label>
          <input type="text" id="sec-code" placeholder="IRR" maxlength="3">
          <input type="text" id="sec-sym" placeholder="﷼" maxlength="5">
          <input type="number" id="sec-minor" placeholder="1" value="1">
          <input type="number" id="sec-rate" placeholder="1.00" step="0.01" value="1.00">
        </div>
        <div class="form-group">
          <label class="toggle">
            <input type="checkbox" id="show-both-currency">
            <span data-i18n="showBoth">نمایش هر دو</span>
          </label>
        </div>
        <div class="button-group">
          <button id="btn-currency-save" class="btn btn-primary" data-i18n="save">ذخیره</button>
          <button id="btn-currency-cancel" class="btn btn-secondary" data-i18n="cancel">لغو</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div id="toast-container" class="toast-container"></div>

  
  <!-- Font Awesome Test -->
  <div style="display:none">
    <i class="fa-solid fa-play" style="color:var(--primary)"></i>
    <i class="fa-solid fa-pause" style="color:var(--secondary)"></i>
    <i class="fa-solid fa-triangle-exclamation" style="color:var(--error)"></i>
  </div>
</body>
</html>
